#{extends 'main.html' /}
#{set title:'Task' /}

<div id="allTasksDiv" style="width:600px;">
<table id="allTasks" class="tablesorter"> 
	<thead> 
	  <tr>
	    <th>Task</th>
	    <th>Assignee</th>
	    <th>Status</th>
	    <th>Recurrence</th>
	    <th>Remaining Date</th>
	  </tr>
	</thead> 
	<tbody> 
	#{list items:tasks, as:'task'}
	  <tr>
	    <td>${task.title}</td>
	    <td>${task.title}</td>
	    <td>${task.title}</td>
	    <td>${task.title}</td>
	    <td><input type="checkbox" id="${task.id}" ${task.done ? 'checked':''}></td>
	  </tr>
	#{/list}
	</tbody> 
</table>
</div>

<p>
	<a id="createTask" href="#">Create a new task</a>
	<script>
		$("#createTask").click(function(){
			$.post('@{createTask()}',{title:prompt('Task Title ?')},function(task){
				$('ul').prepend('<li><input type="checkbox" id="'+task.id+'">'+task.title+'</li>')
				},'json')
		})
	
	//change status
	$('input').click(function(){
		$.post('@{changeStatus()}',{id:$(this).attr('id'),done:$(this).val()})
	});
   </script>
</p>