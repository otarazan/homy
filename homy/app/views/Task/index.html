#{extends 'main.html' /}
#{set title:'Tasks' /}
#{set topBarStyle:'task' /}

<div class="span12"> 

<ul class="nav nav-tabs" id="myTab">
  <li class="active"><a href="#tabs-1">My Tasks</a></li>
  <li><a href="#tabs-2">All Tasks</a></li>
</ul>
<div class="tab-content">
  <div class="tab-pane active" id="tabs-1">
  	<div id="tabs-1">
		#{list items:myTasks, as:'task'}
			<div class="span3 well" id="box_${task.id}">
						<p>${task.title}</p>
						<div>
							<div class="badge badge-important" id="importance_${task.id}">Level:${task.recurrence}</div>
							<div id="countdown_${task.id}"></div><script>countDown("countdown_${task.id}","${task.remainingDate}");</script>
							<center><button type="button" class="btn btn-warning" onclick="passTask(box_${task.id},${task.id})">Pass</button> <button class="btn btn-success" type="button" id="btnDone" onclick="setTaskAsDone(box_${task.id},${task.id})">Done</button></center>
						</div>
						
			</div>
		#{/list}
	</div>
	</div>
  <div class="tab-pane" id="tabs-2">
	
		#{form @Task.addTask(roomId)}
		  <table id="allTasks"  class="table table-striped table-hover tablesorter">
		       <thead>
					<tr>
						<th>Task</th>
						<th>Assignee</th>
						<th></th>
						<th>Importance</th>
						<th>Remaining Date</th>
					</tr>
			</thead>
				<tbody>
					#{list items:allTasks, as:'task'}
					<tr>
						<td>${task.title}</td>
						<td>${task.roomy}</td>
						<td><input type="checkbox" id="${task.id}" ${task.status ? 'checked':''}></td>
						<td>${task.recurrence}</td>
						<td><div id="all_countdown_${task.id}"></div><script>countDown("all_countdown_${task.id}","${task.remainingDate}");</script></td>
					</tr>
					#{/list}
				</tbody>
				<tfoot>
					<tr>
						<td><input type="text" name="task" value="Add new task"></td>
						<td>							
							#{select 'selectedUser', items:allRoomies, valueProperty:'id', labelProperty:'firstName' /}
						</td>
						<td><input type="checkbox"/></td>
						<td>
							<select style="width:50px;" name="recurrence">
							  <option value="1">1</option>
							  <option value="2">2</option>
							  <option value="3">3</option>
							  <option value="4">4</option>
							</select>
						</td>
						<td><input type="text" id="datepicker" name="remainingDate"></td>
					</tr>
				</tfoot>
		  </table>
		    <button name="save" class="btn pull-left btn-success">Save</button>
		#{/form}
  </div>

</div>

<script>
	$('#myTab a').click(function (e) {
		  e.preventDefault();
		  $(this).tab('show');
		})

  $(function () {
    $('#myTab a:last').tab('show');
  })
</script>

</div>